{"ast":null,"code":"import _defineProperty from \"/Users/macbook/Desktop/Software/reactapps/netapp-1/node_modules/@babel/runtime/helpers/esm/defineProperty\";\nvar _jsxFileName = \"/Users/macbook/Desktop/Software/reactapps/netapp-1/src/App.js\";\n\nfunction ownKeys(object, enumerableOnly) { var keys = Object.keys(object); if (Object.getOwnPropertySymbols) { var symbols = Object.getOwnPropertySymbols(object); if (enumerableOnly) symbols = symbols.filter(function (sym) { return Object.getOwnPropertyDescriptor(object, sym).enumerable; }); keys.push.apply(keys, symbols); } return keys; }\n\nfunction _objectSpread(target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i] != null ? arguments[i] : {}; if (i % 2) { ownKeys(source, true).forEach(function (key) { _defineProperty(target, key, source[key]); }); } else if (Object.getOwnPropertyDescriptors) { Object.defineProperties(target, Object.getOwnPropertyDescriptors(source)); } else { ownKeys(source).forEach(function (key) { Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key)); }); } } return target; }\n\nimport * as ml5 from \"ml5\";\nimport * as React from \"react\";\nimport { render } from \"react-dom\";\n\nconst delay = ms => new Promise(resolve => setTimeout(resolve, ms));\n\nclass WhatsInThisImage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.imageRef = React.createRef();\n    this.state = {\n      prediction: {\n        className: \"\",\n        probability: \"\"\n      },\n      isLoading: false,\n      error: null\n    };\n    this.predict = this.predict.bind(this);\n  }\n\n  async predict() {\n    if (!this.imageRef.current) return;\n    this.setState(s => _objectSpread({}, s, {\n      isLoading: true\n    }));\n    console.log(\"HIII\"); // hack for slow connections\n\n    await delay(2000);\n    console.log(\"Hiyein\");\n\n    try {\n      const classifier = await ml5.imageClassifier(\"MobileNet\");\n      const results = await classifier.predict(this.imageRef.current);\n      console.log(\"Hiyein 3\");\n\n      if (results.length === 0) {\n        this.setState({\n          error: new Error(\"NO_PREDICTIONS\"),\n          isLoading: false\n        });\n        return;\n      } else {\n        this.setState({\n          isLoading: false,\n          prediction: {\n            className: results[0].className,\n            probability: results[0].probability\n          }\n        });\n      }\n    } catch (error) {\n      console.log(\"Hiyein 4\");\n      this.setState({\n        error,\n        isLoading: false\n      });\n      return;\n    }\n  }\n\n  async componentDidMount() {\n    if (this.props.renderImage) {\n      await this.predict();\n    }\n  }\n\n  async componentDidUpdate(prevProps) {\n    if (prevProps.renderImage !== this.props.renderImage) {\n      await this.predict();\n    }\n  }\n\n  render() {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61\n      },\n      __self: this\n    }, React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 62\n      },\n      __self: this\n    }, \"The MobileNet model labeled this as\", \" \", React.createElement(\"pre\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 64\n      },\n      __self: this\n    }, this.state.prediction.className), \"with a confidence of \", React.createElement(\"pre\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 65\n      },\n      __self: this\n    }, this.state.prediction.probability)), React.createElement(\"pre\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 67\n      },\n      __self: this\n    }, \"isLoading : \", JSON.stringify(this.state.isLoading)), React.createElement(\"pre\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 68\n      },\n      __self: this\n    }, \"error : \", JSON.stringify(this.state.error, null, 2), \" \", this.state.error !== null && this.state.error.message), this.props.renderImage !== null && this.props.renderImage({\n      ref: this.imageRef\n    }));\n  }\n\n}\n\nrender(React.createElement(WhatsInThisImage, {\n  renderImage: ({\n    ref\n  }) => React.createElement(\"img\", {\n    ref: ref,\n    crossOrigin: \"anonymous\",\n    src: \"./img/person.jpg\",\n    id: \"image\",\n    width: \"400\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82\n    },\n    __self: this\n  }),\n  __source: {\n    fileName: _jsxFileName,\n    lineNumber: 80\n  },\n  __self: this\n}), document.getElementById(\"app\")); // document.getElementById(\"app\").innerHTML = `\n// `;","map":{"version":3,"sources":["/Users/macbook/Desktop/Software/reactapps/netapp-1/src/App.js"],"names":["ml5","React","render","delay","ms","Promise","resolve","setTimeout","WhatsInThisImage","Component","constructor","props","imageRef","createRef","state","prediction","className","probability","isLoading","error","predict","bind","current","setState","s","console","log","classifier","imageClassifier","results","length","Error","componentDidMount","renderImage","componentDidUpdate","prevProps","JSON","stringify","message","ref","document","getElementById"],"mappings":";;;;;;;AAAA,OAAO,KAAKA,GAAZ,MAAqB,KAArB;AACA,OAAO,KAAKC,KAAZ,MAAuB,OAAvB;AACA,SAASC,MAAT,QAAuB,WAAvB;;AAEA,MAAMC,KAAK,GAAGC,EAAE,IAAI,IAAIC,OAAJ,CAAYC,OAAO,IAAIC,UAAU,CAACD,OAAD,EAAUF,EAAV,CAAjC,CAApB;;AACA,MAAMI,gBAAN,SAA+BP,KAAK,CAACQ,SAArC,CAA+C;AAC7CC,EAAAA,WAAW,CAACC,KAAD,EAAQ;AACjB,UAAMA,KAAN;AACA,SAAKC,QAAL,GAAgBX,KAAK,CAACY,SAAN,EAAhB;AACA,SAAKC,KAAL,GAAa;AACXC,MAAAA,UAAU,EAAE;AACVC,QAAAA,SAAS,EAAE,EADD;AAEVC,QAAAA,WAAW,EAAE;AAFH,OADD;AAKXC,MAAAA,SAAS,EAAE,KALA;AAMXC,MAAAA,KAAK,EAAE;AANI,KAAb;AAQA,SAAKC,OAAL,GAAe,KAAKA,OAAL,CAAaC,IAAb,CAAkB,IAAlB,CAAf;AACD;;AACD,QAAMD,OAAN,GAAgB;AACd,QAAI,CAAC,KAAKR,QAAL,CAAcU,OAAnB,EAA4B;AAC5B,SAAKC,QAAL,CAAcC,CAAC,sBAAUA,CAAV;AAAaN,MAAAA,SAAS,EAAE;AAAxB,MAAf;AACAO,IAAAA,OAAO,CAACC,GAAR,CAAY,MAAZ,EAHc,CAId;;AACA,UAAMvB,KAAK,CAAC,IAAD,CAAX;AACAsB,IAAAA,OAAO,CAACC,GAAR,CAAY,QAAZ;;AACA,QAAI;AACF,YAAMC,UAAU,GAAG,MAAM3B,GAAG,CAAC4B,eAAJ,CAAoB,WAApB,CAAzB;AACA,YAAMC,OAAO,GAAG,MAAMF,UAAU,CAACP,OAAX,CAAmB,KAAKR,QAAL,CAAcU,OAAjC,CAAtB;AACAG,MAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ;;AACA,UAAIG,OAAO,CAACC,MAAR,KAAmB,CAAvB,EAA0B;AACxB,aAAKP,QAAL,CAAc;AAAEJ,UAAAA,KAAK,EAAE,IAAIY,KAAJ,CAAU,gBAAV,CAAT;AAAsCb,UAAAA,SAAS,EAAE;AAAjD,SAAd;AACA;AACD,OAHD,MAGO;AACL,aAAKK,QAAL,CAAc;AACZL,UAAAA,SAAS,EAAE,KADC;AAEZH,UAAAA,UAAU,EAAE;AACVC,YAAAA,SAAS,EAAEa,OAAO,CAAC,CAAD,CAAP,CAAWb,SADZ;AAEVC,YAAAA,WAAW,EAAEY,OAAO,CAAC,CAAD,CAAP,CAAWZ;AAFd;AAFA,SAAd;AAOD;AACF,KAhBD,CAgBE,OAAOE,KAAP,EAAc;AACdM,MAAAA,OAAO,CAACC,GAAR,CAAY,UAAZ;AACA,WAAKH,QAAL,CAAc;AAAEJ,QAAAA,KAAF;AAASD,QAAAA,SAAS,EAAE;AAApB,OAAd;AACA;AACD;AACF;;AACD,QAAMc,iBAAN,GAA0B;AACxB,QAAI,KAAKrB,KAAL,CAAWsB,WAAf,EAA4B;AAC1B,YAAM,KAAKb,OAAL,EAAN;AACD;AACF;;AACD,QAAMc,kBAAN,CAAyBC,SAAzB,EAAoC;AAClC,QAAIA,SAAS,CAACF,WAAV,KAA0B,KAAKtB,KAAL,CAAWsB,WAAzC,EAAsD;AACpD,YAAM,KAAKb,OAAL,EAAN;AACD;AACF;;AACDlB,EAAAA,MAAM,GAAG;AACP,WACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OACE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,8CACsC,GADtC,EAEE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAM,KAAKY,KAAL,CAAWC,UAAX,CAAsBC,SAA5B,CAFF,2BAGuB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,OAAM,KAAKF,KAAL,CAAWC,UAAX,CAAsBE,WAA5B,CAHvB,CADF,EAME;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,uBAAkBmB,IAAI,CAACC,SAAL,CAAe,KAAKvB,KAAL,CAAWI,SAA1B,CAAlB,CANF,EAOE;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,mBACWkB,IAAI,CAACC,SAAL,CAAe,KAAKvB,KAAL,CAAWK,KAA1B,EAAiC,IAAjC,EAAuC,CAAvC,CADX,EACsD,GADtD,EAEG,KAAKL,KAAL,CAAWK,KAAX,KAAqB,IAArB,IAA6B,KAAKL,KAAL,CAAWK,KAAX,CAAiBmB,OAFjD,CAPF,EAWG,KAAK3B,KAAL,CAAWsB,WAAX,KAA2B,IAA3B,IACC,KAAKtB,KAAL,CAAWsB,WAAX,CAAuB;AAAEM,MAAAA,GAAG,EAAE,KAAK3B;AAAZ,KAAvB,CAZJ,CADF;AAgBD;;AAtE4C;;AAyE/CV,MAAM,CACJ,oBAAC,gBAAD;AACE,EAAA,WAAW,EAAE,CAAC;AAAEqC,IAAAA;AAAF,GAAD,KACX;AACE,IAAA,GAAG,EAAEA,GADP;AAEE,IAAA,WAAW,EAAC,WAFd;AAGE,IAAA,GAAG,EAAC,kBAHN;AAIE,IAAA,EAAE,EAAC,OAJL;AAKE,IAAA,KAAK,EAAC,KALR;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,IAFJ;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,EADI,EAYJC,QAAQ,CAACC,cAAT,CAAwB,KAAxB,CAZI,CAAN,C,CAcA;AACA","sourcesContent":["import * as ml5 from \"ml5\";\nimport * as React from \"react\";\nimport { render } from \"react-dom\";\n\nconst delay = ms => new Promise(resolve => setTimeout(resolve, ms));\nclass WhatsInThisImage extends React.Component {\n  constructor(props) {\n    super(props);\n    this.imageRef = React.createRef();\n    this.state = {\n      prediction: {\n        className: \"\",\n        probability: \"\"\n      },\n      isLoading: false,\n      error: null\n    };\n    this.predict = this.predict.bind(this);\n  }\n  async predict() {\n    if (!this.imageRef.current) return;\n    this.setState(s => ({ ...s, isLoading: true }));\n    console.log(\"HIII\");\n    // hack for slow connections\n    await delay(2000);\n    console.log(\"Hiyein\");\n    try {\n      const classifier = await ml5.imageClassifier(\"MobileNet\");\n      const results = await classifier.predict(this.imageRef.current);\n      console.log(\"Hiyein 3\");\n      if (results.length === 0) {\n        this.setState({ error: new Error(\"NO_PREDICTIONS\"), isLoading: false });\n        return;\n      } else {\n        this.setState({\n          isLoading: false,\n          prediction: {\n            className: results[0].className,\n            probability: results[0].probability\n          }\n        });\n      }\n    } catch (error) {\n      console.log(\"Hiyein 4\");\n      this.setState({ error, isLoading: false });\n      return;\n    }\n  }\n  async componentDidMount() {\n    if (this.props.renderImage) {\n      await this.predict();\n    }\n  }\n  async componentDidUpdate(prevProps) {\n    if (prevProps.renderImage !== this.props.renderImage) {\n      await this.predict();\n    }\n  }\n  render() {\n    return (\n      <div>\n        <div>\n          The MobileNet model labeled this as{\" \"}\n          <pre>{this.state.prediction.className}</pre>\n          with a confidence of <pre>{this.state.prediction.probability}</pre>\n        </div>\n        <pre>isLoading : {JSON.stringify(this.state.isLoading)}</pre>\n        <pre>\n          error : {JSON.stringify(this.state.error, null, 2)}{\" \"}\n          {this.state.error !== null && this.state.error.message}\n        </pre>\n        {this.props.renderImage !== null &&\n          this.props.renderImage({ ref: this.imageRef })}\n      </div>\n    );\n  }\n}\n\nrender(\n  <WhatsInThisImage\n    renderImage={({ ref }) => (\n      <img\n        ref={ref}\n        crossOrigin=\"anonymous\"\n        src=\"./img/person.jpg\"\n        id=\"image\"\n        width=\"400\"\n      />\n    )}\n  />,\n  document.getElementById(\"app\")\n);\n// document.getElementById(\"app\").innerHTML = `\n// `;\n"]},"metadata":{},"sourceType":"module"}